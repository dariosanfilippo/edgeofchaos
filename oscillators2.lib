// MORE OSCILLATORS

ba = library("basics.lib");
ma = library("maths.lib");
m2 = library("maths2.lib");
o2 = library("oscillators2.lib");

// phasor with phase reset
ph(freq, reset) = freq/ma.SR : (+ : ma.decimal) ~ _ : *(1-(reset : !=(0)));

// unipolar BLIT
blit_up(f, h) = ba.if(phase ==(0), 1, sinc)
with {
      sinc =   sin(phase*h_1),
               sin(phase) :    m2.div, 
                               h_1 : m2.div;
      phase = ph(f_1, 0)*2*ma.PI;
      f_1 = f/2;
      h_1 = m2.diff(phase) : <(0),
            (h*2+1 : min(lim) : int) : ba.sAndH;
      lim = ba.if( (int(ma.SR/f) : %(2) : ==(0)), 
                   int(ma.SR/f)-1, 
                   int(ma.SR/f));
};

// bipolar BLIT
blit_bp(f, h, d) = m2.delta(blit_up(f, h), d_1)
with {
      d_1 = d*(1/f);
};
